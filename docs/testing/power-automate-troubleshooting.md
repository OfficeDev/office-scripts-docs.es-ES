---
title: Solución de problemas de información Power Automate con scripts Office datos
description: Sugerencias, información de plataforma y problemas conocidos con la integración entre Office scripts y Power Automate.
ms.date: 01/14/2021
localization_priority: Normal
ms.openlocfilehash: bcfedb8db88d74f16e46c604121bceff3c7c7382
ms.sourcegitcommit: f7a7aebfb687f2a35dbed07ed62ff352a114525a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/06/2021
ms.locfileid: "52232651"
---
# <a name="troubleshooting-information-for-power-automate-with-office-scripts"></a><span data-ttu-id="c1ab4-103">Solución de problemas de información Power Automate con scripts Office datos</span><span class="sxs-lookup"><span data-stu-id="c1ab4-103">Troubleshooting information for Power Automate with Office Scripts</span></span>

<span data-ttu-id="c1ab4-104">Power Automate permite llevar la automatización Office script al siguiente nivel.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-104">Power Automate lets you take your Office Script automation to the next level.</span></span> <span data-ttu-id="c1ab4-105">Sin embargo, como Power Automate scripts en su nombre en sesiones Excel independientes, hay algunas cosas importantes que tener en cuenta.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-105">However, because Power Automate runs scripts on your behalf in independent Excel sessions, there are a few important things to note.</span></span>

> [!TIP]
> <span data-ttu-id="c1ab4-106">Si está empezando a usar scripts de Office con Power Automate, comience con Ejecutar scripts de [Office](../develop/power-automate-integration.md) con Power Automate para obtener información sobre las plataformas.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-106">If you're just starting to use Office Scripts with Power Automate, please start with [Run Office Scripts with Power Automate](../develop/power-automate-integration.md) to learn about the platforms.</span></span>

## <a name="avoid-using-relative-references"></a><span data-ttu-id="c1ab4-107">Evitar el uso de referencias relativas</span><span class="sxs-lookup"><span data-stu-id="c1ab4-107">Avoid using relative references</span></span>

<span data-ttu-id="c1ab4-108">Power Automate ejecuta el script en el libro Excel en su nombre.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-108">Power Automate runs your script in the chosen Excel workbook on your behalf.</span></span> <span data-ttu-id="c1ab4-109">Es posible que el libro se cierre cuando esto suceda.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-109">The workbook might be closed when this happens.</span></span> <span data-ttu-id="c1ab4-110">Cualquier API que se base en el estado actual del usuario, como , puede comportarse de forma diferente `Workbook.getActiveWorksheet` en Power Automate.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-110">Any API that relies on the user's current state, such as `Workbook.getActiveWorksheet`, may behave differently in Power Automate.</span></span> <span data-ttu-id="c1ab4-111">Esto se debe a que las API se basan en una posición relativa de la vista o el cursor del usuario y esa referencia no existe en un flujo Power Automate usuario.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-111">This is because the APIs are based on a relative position of the user's view or cursor and that reference doesn't exist in a Power Automate flow.</span></span>

<span data-ttu-id="c1ab4-112">Algunas API de referencia relativas producen errores en Power Automate.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-112">Some relative reference APIs throw errors in Power Automate.</span></span> <span data-ttu-id="c1ab4-113">Otros tienen un comportamiento predeterminado que implica el estado de un usuario.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-113">Others have a default behavior that implies a user's state.</span></span> <span data-ttu-id="c1ab4-114">Al diseñar los scripts, asegúrese de usar referencias absolutas para hojas de cálculo e intervalos.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-114">When designing your scripts, be sure to use absolute references for worksheets and ranges.</span></span> <span data-ttu-id="c1ab4-115">Esto hace que Power Automate flujo de trabajo coherente, incluso si las hojas de cálculo se reorganizan.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-115">This makes your Power Automate flow consistent, even if worksheets are rearranged.</span></span>

### <a name="script-methods-that-fail-when-run-power-automate-flows"></a><span data-ttu-id="c1ab4-116">Métodos de script que fallan al ejecutar Power Automate flujos</span><span class="sxs-lookup"><span data-stu-id="c1ab4-116">Script methods that fail when run Power Automate flows</span></span>

<span data-ttu-id="c1ab4-117">Los métodos siguientes producirán un error y producirán un error cuando se llame desde un script en un flujo Power Automate.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-117">The following methods will throw an error and fail when called from a script in a Power Automate flow.</span></span>

| <span data-ttu-id="c1ab4-118">Clase</span><span class="sxs-lookup"><span data-stu-id="c1ab4-118">Class</span></span> | <span data-ttu-id="c1ab4-119">Método</span><span class="sxs-lookup"><span data-stu-id="c1ab4-119">Method</span></span> |
|--|--|
| [<span data-ttu-id="c1ab4-120">Chart</span><span class="sxs-lookup"><span data-stu-id="c1ab4-120">Chart</span></span>](/javascript/api/office-scripts/excelscript/excelscript.chart) | `activate` |
| [<span data-ttu-id="c1ab4-121">Range</span><span class="sxs-lookup"><span data-stu-id="c1ab4-121">Range</span></span>](/javascript/api/office-scripts/excelscript/excelscript.range) | `select` |
| [<span data-ttu-id="c1ab4-122">Workbook</span><span class="sxs-lookup"><span data-stu-id="c1ab4-122">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveCell` |
| [<span data-ttu-id="c1ab4-123">Workbook</span><span class="sxs-lookup"><span data-stu-id="c1ab4-123">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveChart` |
| [<span data-ttu-id="c1ab4-124">Workbook</span><span class="sxs-lookup"><span data-stu-id="c1ab4-124">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveSlicer` |
| [<span data-ttu-id="c1ab4-125">Workbook</span><span class="sxs-lookup"><span data-stu-id="c1ab4-125">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRange` |
| [<span data-ttu-id="c1ab4-126">Workbook</span><span class="sxs-lookup"><span data-stu-id="c1ab4-126">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRanges` |

### <a name="script-methods-with-a-default-behavior-in-power-automate-flows"></a><span data-ttu-id="c1ab4-127">Métodos de script con un comportamiento predeterminado en Power Automate flujos</span><span class="sxs-lookup"><span data-stu-id="c1ab4-127">Script methods with a default behavior in Power Automate flows</span></span>

<span data-ttu-id="c1ab4-128">Los siguientes métodos usan un comportamiento predeterminado, en lugar del estado actual de cualquier usuario.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-128">The following methods use a default behavior, in lieu of any user's current state.</span></span>

| <span data-ttu-id="c1ab4-129">Clase</span><span class="sxs-lookup"><span data-stu-id="c1ab4-129">Class</span></span> | <span data-ttu-id="c1ab4-130">Método</span><span class="sxs-lookup"><span data-stu-id="c1ab4-130">Method</span></span> | <span data-ttu-id="c1ab4-131">Power Automate comportamiento</span><span class="sxs-lookup"><span data-stu-id="c1ab4-131">Power Automate behavior</span></span> |
|--|--|--|
| [<span data-ttu-id="c1ab4-132">Workbook</span><span class="sxs-lookup"><span data-stu-id="c1ab4-132">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveWorksheet` | <span data-ttu-id="c1ab4-133">Devuelve la primera hoja de cálculo del libro o la hoja de cálculo activada actualmente por el `Worksheet.activate` método.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-133">Returns either the first worksheet in the workbook or the worksheet currently activated by the `Worksheet.activate` method.</span></span> |
| [<span data-ttu-id="c1ab4-134">Worksheet</span><span class="sxs-lookup"><span data-stu-id="c1ab4-134">Worksheet</span></span>](/javascript/api/office-scripts/excelscript/excelscript.worksheet) | `activate` | <span data-ttu-id="c1ab4-135">Marca la hoja de cálculo como la hoja de cálculo activa para fines de `Workbook.getActiveWorksheet` .</span><span class="sxs-lookup"><span data-stu-id="c1ab4-135">Marks the worksheet as the active worksheet for purposes of `Workbook.getActiveWorksheet`.</span></span> |

## <a name="select-workbooks-with-the-file-browser-control"></a><span data-ttu-id="c1ab4-136">Seleccionar libros con el control del explorador de archivos</span><span class="sxs-lookup"><span data-stu-id="c1ab4-136">Select workbooks with the file browser control</span></span>

<span data-ttu-id="c1ab4-137">Al compilar el **paso Ejecutar script** de un flujo Power Automate, debe seleccionar qué libro forma parte del flujo.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-137">When building the **Run script** step of a Power Automate flow, you need to select which workbook is part of the flow.</span></span> <span data-ttu-id="c1ab4-138">Use el explorador de archivos para seleccionar el libro, en lugar de escribir manualmente el nombre del libro.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-138">Use the file browser to select your workbook, instead of manually typing the workbook's name.</span></span>

:::image type="content" source="../images/power-automate-file-browser.png" alt-text="La Power Automate ejecutar script que muestra la opción Mostrar explorador de archivos selector":::

<span data-ttu-id="c1ab4-140">Para obtener más contexto sobre la limitación Power Automate y una discusión sobre posibles soluciones alternativas para la selección dinámica de libros, vea este subproceso en microsoft [Power Automate Community](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#).</span><span class="sxs-lookup"><span data-stu-id="c1ab4-140">For more context on the Power Automate limitation and a discussion of potential workarounds for the dynamic selection of workbooks, see [this thread in the Microsoft Power Automate Community](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#).</span></span>

## <a name="time-zone-differences"></a><span data-ttu-id="c1ab4-141">Diferencias de zona horaria</span><span class="sxs-lookup"><span data-stu-id="c1ab4-141">Time zone differences</span></span>

<span data-ttu-id="c1ab4-142">Excel archivos no tienen una ubicación o zona horaria inherentes.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-142">Excel files don't have an inherent location or timezone.</span></span> <span data-ttu-id="c1ab4-143">Cada vez que un usuario abre el libro, su sesión usa la zona horaria local de ese usuario para los cálculos de fecha.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-143">Every time a user opens the workbook, their session uses that user's local timezone for date calculations.</span></span> <span data-ttu-id="c1ab4-144">Power Automate siempre usa UTC.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-144">Power Automate always uses UTC.</span></span>

<span data-ttu-id="c1ab4-145">Si el script usa fechas u horas, puede haber diferencias de comportamiento cuando el script se prueba localmente frente a cuando se ejecuta a través de Power Automate.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-145">If your script uses dates or times, there may be behavioral differences when the script is tested locally versus when it is run through Power Automate.</span></span> <span data-ttu-id="c1ab4-146">Power Automate permite convertir, dar formato y ajustar tiempos.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-146">Power Automate allows you to convert, format, and adjust times.</span></span> <span data-ttu-id="c1ab4-147">Consulte [Trabajar](https://flow.microsoft.com/blog/working-with-dates-and-times/) con fechas y horas dentro de los flujos para obtener instrucciones sobre cómo usar esas funciones en Power Automate y [ `main` Parámetros:](../develop/power-automate-integration.md#main-parameters-passing-data-to-a-script) pasar datos a un script para obtener información sobre cómo proporcionar esa información de hora para el script.</span><span class="sxs-lookup"><span data-stu-id="c1ab4-147">See [Working with Dates and Times inside of your flows](https://flow.microsoft.com/blog/working-with-dates-and-times/) for instructions on how to use those functions in Power Automate and [`main` Parameters: Passing data to a script](../develop/power-automate-integration.md#main-parameters-passing-data-to-a-script) to learn how to provide that time information for the script.</span></span>

## <a name="see-also"></a><span data-ttu-id="c1ab4-148">Vea también</span><span class="sxs-lookup"><span data-stu-id="c1ab4-148">See also</span></span>

- [<span data-ttu-id="c1ab4-149">Solución de problemas de scripts de Office</span><span class="sxs-lookup"><span data-stu-id="c1ab4-149">Troubleshooting Office Scripts</span></span>](troubleshooting.md)
- [<span data-ttu-id="c1ab4-150">Ejecute Office scripts con Power Automate</span><span class="sxs-lookup"><span data-stu-id="c1ab4-150">Run Office Scripts with Power Automate</span></span>](../develop/power-automate-integration.md)
- [<span data-ttu-id="c1ab4-151">Excel Documentación de referencia del conector en línea (empresa)</span><span class="sxs-lookup"><span data-stu-id="c1ab4-151">Excel Online (Business) connector reference documentation</span></span>](/connectors/excelonlinebusiness/)
